import{k as e,D as a,B as l,b as t,I as d,J as o,r as i,o as n,e as s,f as r,g as u,w as m,F as c,l as f,c as b,i as p,t as v,M as g,E as D,p as V,j as k}from"./vendor.dbb6efc1.js";import{W as y}from"./wangEditor.d9c38480.js";import{e as _,f as h,h as x}from"./index.f36149e3.js";import{_ as C}from"./index.18cffda6.js";const q={name:"productAdd",setup(){const i=e();let n=!1;const s=a(null),r=a(null),u=a(""),m=a(!1),c=l({title:"",address:"",region:"",beginDate:"",endDate:"",amount:0,amountDescribe:"",describe:"",cover:"",link:[]});let f;t((()=>{console.log("获取到的参数：",i.query.activityId),f=new y(s.value),f.config.uploadVideoServer="/common/video/upload",f.config.uploadVideoMaxSize=41943040,f.config.uploadVideoAccept=["mp4"],f.config.uploadVideoName="file",f.config.zIndex=1,f.create(),null!=i.query.activityId&&(n=!0,_({id:i.query.activityId}).then((e=>{c.title=e.data.title,c.address=e.data.address,c.beginDate=e.data.startTime+"",c.endDate=e.data.endTime+"",c.amount=e.data.amount/100,c.cover=e.data.cover,c.link=e.data.link.split(","),c.amountDescribe=e.data.amountDescribe,f.txt.html(e.data.describe)})))})),d((()=>i.path),(()=>{console.log("监听到变化"),console.log("获取到的参数：",i.query.activityId),null!=i.query.activityId&&(n=!0,_({id:i.query.activityId}).then((e=>{c.title=e.data.title,c.address=e.data.address,c.beginDate=e.data.startTime+"",c.endDate=e.data.endTime+"",c.amount=e.data.amount/100,c.cover=e.data.cover,c.link=e.data.link.split(","),c.amountDescribe=e.data.amountDescribe,f.txt.html(e.data.describe)})))})),o((()=>{f.destroy(),f=null}));return{addVaule:u,addVisible:m,showAddLink:()=>{m.value=!0},addLinkConfirm:()=>{c.link.push(u.value),u.value="",m.value=!1},addLinkColse:e=>{c.link.splice(c.link.indexOf(e),1)},editor:s,rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],address:[{required:!0,message:"请输入活动地址",trigger:"blur"}],beginDate:[{required:!0,message:"请输入开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},formRef:r,form:c,onSubmit:()=>{c.describe=f.txt.html(),r.value.validate((e=>{if(!e)return!1;n?(x({title:c.title,address:c.address,startTime:c.beginDate,endTime:c.endDate,describe:c.describe,link:c.link,amount:c.amount,cover:c.cover,id:i.query.activityId,amountDescribe:c.amountDescribe}).then((e=>{console.log(e)})),D.success("提交成功！")):(h({title:c.title,address:c.address,startTime:c.beginDate,endTime:c.endDate,describe:c.describe,link:c.link,amount:c.amount,cover:c.cover,amountDescribe:c.amountDescribe}).then((e=>{console.log(e)})),D.success("提交成功！"))}))},onReset:()=>{r.value.resetFields()}}}},z={class:"crumbs"},w=(e=>(V("data-v-5499eb3a"),e=e(),k(),e))((()=>r("i",{class:"el-icon-lx-calendar"},null,-1))),I=p(" 活动 "),T=p("编辑"),U={class:"container"},Y={class:"form-box"},L=p("+ 新增活动环节"),M={class:"mgb20",ref:"editor"},j=p("保存"),A=p("重置");var H=C(q,[["render",function(e,a,l,t,d,o){const D=i("el-breadcrumb-item"),V=i("el-breadcrumb"),k=i("el-input"),y=i("el-form-item"),_=i("el-input-number"),h=i("el-tag"),x=i("el-button"),C=i("el-date-picker"),q=i("el-col"),H=i("el-form");return n(),s("div",null,[r("div",z,[u(V,{separator:"/"},{default:m((()=>[u(D,null,{default:m((()=>[w,I])),_:1}),u(D,null,{default:m((()=>[T])),_:1})])),_:1})]),r("div",U,[r("div",Y,[u(H,{ref:"formRef",rules:t.rules,model:t.form,"label-width":"80px"},{default:m((()=>[u(y,{label:"活动名称",prop:"title"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.title,"onUpdate:modelValue":a[0]||(a[0]=e=>t.form.title=e)},null,8,["modelValue"])])),_:1}),u(y,{label:"活动地址",prop:"address"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.address,"onUpdate:modelValue":a[1]||(a[1]=e=>t.form.address=e)},null,8,["modelValue"])])),_:1}),u(y,{label:"活动封面",prop:"cover"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.cover,"onUpdate:modelValue":a[2]||(a[2]=e=>t.form.cover=e),placeholder:"请输入封面图片网络地址"},null,8,["modelValue"])])),_:1}),u(y,{label:"费用(元)",prop:"amount"},{default:m((()=>[u(_,{size:"mini",modelValue:t.form.amount,"onUpdate:modelValue":a[3]||(a[3]=e=>t.form.amount=e),min:0},null,8,["modelValue"])])),_:1}),u(y,{label:"费用描述",prop:"amountDescribe"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.amountDescribe,"onUpdate:modelValue":a[4]||(a[4]=e=>t.form.amountDescribe=e)},null,8,["modelValue"])])),_:1}),u(y,{label:"活动环节",prop:"link"},{default:m((()=>[(n(!0),s(c,null,f(t.form.link,(e=>(n(),b(h,{key:e,closable:"","disable-transitions":!1,onClose:a=>t.addLinkColse(e)},{default:m((()=>[p(v(e),1)])),_:2},1032,["onClose"])))),128)),t.addVisible?(n(),b(k,{key:0,modelValue:t.addVaule,"onUpdate:modelValue":a[5]||(a[5]=e=>t.addVaule=e),class:"input-new-tag",size:"mini",onKeyup:g(t.addLinkConfirm,["enter"])},null,8,["modelValue","onKeyup"])):(n(),b(x,{key:1,class:"button-new-tag",size:"small",onClick:t.showAddLink},{default:m((()=>[L])),_:1},8,["onClick"]))])),_:1}),u(y,{label:"开始时间"},{default:m((()=>[u(q,{span:11},{default:m((()=>[u(y,{prop:"beginDate"},{default:m((()=>[u(C,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:t.form.beginDate,"onUpdate:modelValue":a[6]||(a[6]=e=>t.form.beginDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(y,{label:"结束时间"},{default:m((()=>[u(q,{span:11},{default:m((()=>[u(y,{prop:"endDate"},{default:m((()=>[u(C,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:t.form.endDate,"onUpdate:modelValue":a[7]||(a[7]=e=>t.form.endDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(y,{label:"活动描述"},{default:m((()=>[r("div",M,null,512)])),_:1}),u(y,null,{default:m((()=>[u(x,{type:"primary",onClick:t.onSubmit},{default:m((()=>[j])),_:1},8,["onClick"]),u(x,{onClick:t.onReset},{default:m((()=>[A])),_:1},8,["onClick"])])),_:1})])),_:1},8,["rules","model"])])])])}],["__scopeId","data-v-5499eb3a"]]);export{H as default};
