import{d as e,B as a,D as l,r as t,o as d,e as o,f as i,g as n,w as r,G as c,H as s,E as p,L as u,p as b,j as g,i as h}from"./vendor.726ac693.js";import{b as v,c as m,d as f}from"./index.1b91213e.js";import{_ as y}from"./index.10a4c524.js";const C={name:"userstable",setup(){const t=e(),d=a({address:"",openId:"",pageIndex:1,pageSize:10}),o=l([]),i=l(0),n=l(""),r=l(!1),c=l(0),s=l(!0),b=()=>{v({limit:d.pageSize,offset:d.pageSize*(d.pageIndex-1)}).then((e=>{o.value=e.data.activityList,i.value=e.data.total}))};b();const g=l(!1);let h=a({name:"",address:""});return{query:d,tableData:o,pageTotal:i,editVisible:g,qrcodeShow:r,form:h,qrcode:n,tipShow:s,generateId:c,generateQrcode:()=>{console.log(c.value),m({activityId:c.value}).then((e=>{0==e.errno&&(n.value=e.data.qrcode,p.success("生成成功"),s.value=!1)}))},downloadQrcode:()=>{window.location.href=`${n.value}`},handleAdd:()=>{t.push("/productAdd")},handlePageChange:e=>{d.pageIndex=e,b()},handleDelete:(e,a)=>{u.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{f({activityId:a.id}).then((a=>{0==a.errno?(p.success("删除成功"),o.value.splice(e,1)):p.success("删除失败")}))})).catch((()=>{}))},handleEdit:(e,a)=>{t.push({path:"/productAdd",query:{activityId:a.id}})},handleQrcode:(e,a)=>{c.value=a.id,g.value=!0,a.qrcode?(n.value=a.qrcode,r.value=!0,s.value=!1):(r.value=!1,s.value=!0)},saveEdit:()=>{g.value=!1,p.success("修改第 0 行成功"),Object.keys(h).forEach((e=>{o.value[-1][e]=h[e]}))}}}},k={class:"crumbs"},w=(e=>(b("data-v-186758bd"),e=e(),g(),e))((()=>i("i",{class:"el-icon-lx-cascades"},null,-1))),x=h(" 用户列表 "),_={class:"container"},q={class:"handle-box"},I=h("新增活动"),S=h("编辑 "),V=h("复制 "),z=h("二维码 "),Q=h("删除"),j={class:"pagination"},D={class:"dialog-footer"},E=h("取 消"),T=h("生成"),$=h("下载");var A=y(C,[["render",function(e,a,l,p,u,b){const g=t("el-breadcrumb-item"),h=t("el-breadcrumb"),v=t("el-button"),m=t("el-table-column"),f=t("el-table"),y=t("el-pagination"),C=t("el-empty"),A=t("el-dialog");return d(),o("div",null,[i("div",k,[n(h,{separator:"/"},{default:r((()=>[n(g,null,{default:r((()=>[w,x])),_:1})])),_:1})]),i("div",_,[i("div",q,[n(v,{type:"primary",icon:"el-icon-circle-plus-outline",onClick:p.handleAdd},{default:r((()=>[I])),_:1},8,["onClick"])]),n(f,{data:p.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:r((()=>[n(m,{prop:"id",label:"活动id",align:"center"}),n(m,{prop:"title",label:"活动标题"}),n(m,{prop:"amount",label:"活动金额"}),n(m,{"show-overflow-tooltip":"",prop:"describe",label:"活动描述"}),n(m,{prop:"link",label:"活动环节"}),n(m,{prop:"address",label:"地址"}),n(m,{prop:"startTime",label:"活动开始时间"}),n(m,{prop:"startTime",label:"活动结束时间"}),n(m,{label:"操作",width:"180",align:"center"},{default:r((a=>[n(v,{type:"text",icon:"el-icon-edit",onClick:e=>p.handleEdit(a.$index,a.row)},{default:r((()=>[S])),_:2},1032,["onClick"]),n(v,{type:"text",icon:"el-icon-edit",onClick:l=>e.handleCopy(a.$index,a.row)},{default:r((()=>[V])),_:2},1032,["onClick"]),n(v,{type:"text",icon:"el-icon-link",onClick:e=>p.handleQrcode(a.$index,a.row)},{default:r((()=>[z])),_:2},1032,["onClick"]),n(v,{type:"text",icon:"el-icon-delete",class:"red",onClick:e=>p.handleDelete(a.$index,a.row)},{default:r((()=>[Q])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),i("div",j,[n(y,{background:"",layout:"total, prev, pager, next","current-page":p.query.pageIndex,"page-size":p.query.pageSize,total:p.pageTotal,onCurrentChange:p.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),n(A,{title:"编辑",modelValue:p.editVisible,"onUpdate:modelValue":a[1]||(a[1]=e=>p.editVisible=e),width:"30%"},{footer:r((()=>[i("span",D,[n(v,{onClick:a[0]||(a[0]=e=>p.editVisible=!1)},{default:r((()=>[E])),_:1}),n(v,{type:"primary",onClick:p.generateQrcode},{default:r((()=>[T])),_:1},8,["onClick"]),n(v,{type:"primary",onClick:p.downloadQrcode},{default:r((()=>[$])),_:1},8,["onClick"])])])),default:r((()=>[c(n(C,{description:"扫码体验小程序",image:p.qrcode},null,8,["image"]),[[s,!p.tipShow]]),c(n(C,{description:"当前活动还未生成分享二维码"},null,512),[[s,p.tipShow]])])),_:1},8,["modelValue"])])}],["__scopeId","data-v-186758bd"]]);export{A as default};
