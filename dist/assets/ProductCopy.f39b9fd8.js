import{j as e,B as l,z as a,b as d,H as o,r as t,o as i,e as n,f as r,g as s,w as u,i as m,F as c,k as f,c as p,t as b,I as g,C as V}from"./vendor.a6d9e6a0.js";import{W as v}from"./wangEditor.789ec17b.js";import{e as k,f as D}from"./index.9f67f35d.js";import{_}from"./index.c00c347b.js";const y={class:"crumbs"},h={class:"container"},C={class:"form-box"},z={class:"mgb20",ref:"editor"};var x=_({name:"productAdd",setup(){e();const t=l(null),i=l(null),n=l(""),r=l(!1),s=a({title:"",address:"",region:"",beginDate:"",endDate:"",amount:0,amountDescribe:"",describe:"",cover:"",link:[]});let u;d((()=>{let e=localStorage.getItem("copyActivityId");console.log("copyId：",e),u=new v(t.value),u.config.uploadVideoServer="/common/video/upload",u.config.uploadVideoMaxSize=41943040,u.config.uploadVideoAccept=["mp4"],u.config.uploadVideoName="file",u.config.zIndex=1,u.create(),e&&k({id:e}).then((e=>{s.title=e.data.title,s.address=e.data.address,s.beginDate=e.data.startTime+"",s.endDate=e.data.endTime+"",s.amount=e.data.amount/100,s.cover=e.data.cover,s.link=e.data.link?e.data.link.split(","):[],s.amountDescribe=e.data.amountDescribe,u.txt.html(e.data.describe)})),localStorage.removeItem("copyActivityId")})),o((()=>{u.destroy(),u=null}));return{addVaule:n,addVisible:r,showAddLink:()=>{r.value=!0},addLinkConfirm:()=>{s.link.push(n.value),n.value="",r.value=!1},addLinkColse:e=>{s.link.splice(s.link.indexOf(e),1)},editor:t,rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],address:[{required:!0,message:"请输入活动地址",trigger:"blur"}],beginDate:[{required:!0,message:"请输入开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},formRef:i,form:s,onSubmit:()=>{s.describe=u.txt.html(),i.value.validate((e=>{if(!e)return!1;D({title:s.title,address:s.address,startTime:s.beginDate,endTime:s.endDate,describe:s.describe,link:s.link,amount:s.amount,cover:s.cover,amountDescribe:s.amountDescribe}).then((e=>{console.log(e)})),V.success("提交成功！")}))},onReset:()=>{i.value.resetFields()}}}},[["render",function(e,l,a,d,o,V){const v=t("el-breadcrumb-item"),k=t("el-breadcrumb"),D=t("el-input"),_=t("el-form-item"),x=t("el-input-number"),w=t("el-tag"),I=t("el-button"),U=t("el-date-picker"),Y=t("el-col"),A=t("el-form");return i(),n("div",null,[r("div",y,[s(k,{separator:"/"},{default:u((()=>[s(v,null,{default:u((()=>l[8]||(l[8]=[r("i",{class:"el-icon-lx-calendar"},null,-1),m(" 活动 ")]))),_:1}),s(v,null,{default:u((()=>l[9]||(l[9]=[m("编辑")]))),_:1})])),_:1})]),r("div",h,[r("div",C,[s(A,{ref:"formRef",rules:d.rules,model:d.form,"label-width":"80px"},{default:u((()=>[s(_,{label:"活动名称",prop:"title"},{default:u((()=>[s(D,{size:"mini",modelValue:d.form.title,"onUpdate:modelValue":l[0]||(l[0]=e=>d.form.title=e)},null,8,["modelValue"])])),_:1}),s(_,{label:"活动地址",prop:"address"},{default:u((()=>[s(D,{size:"mini",modelValue:d.form.address,"onUpdate:modelValue":l[1]||(l[1]=e=>d.form.address=e)},null,8,["modelValue"])])),_:1}),s(_,{label:"活动封面",prop:"cover"},{default:u((()=>[s(D,{size:"mini",modelValue:d.form.cover,"onUpdate:modelValue":l[2]||(l[2]=e=>d.form.cover=e),placeholder:"请输入封面图片网络地址"},null,8,["modelValue"])])),_:1}),s(_,{label:"费用(元)",prop:"amount"},{default:u((()=>[s(x,{size:"mini",modelValue:d.form.amount,"onUpdate:modelValue":l[3]||(l[3]=e=>d.form.amount=e),min:0},null,8,["modelValue"])])),_:1}),s(_,{label:"费用描述",prop:"amountDescribe"},{default:u((()=>[s(D,{size:"mini",modelValue:d.form.amountDescribe,"onUpdate:modelValue":l[4]||(l[4]=e=>d.form.amountDescribe=e)},null,8,["modelValue"])])),_:1}),s(_,{label:"活动环节",prop:"link"},{default:u((()=>[(i(!0),n(c,null,f(d.form.link,(e=>(i(),p(w,{key:e,closable:"","disable-transitions":!1,onClose:l=>d.addLinkColse(e)},{default:u((()=>[m(b(e),1)])),_:2},1032,["onClose"])))),128)),d.addVisible?(i(),p(D,{key:0,modelValue:d.addVaule,"onUpdate:modelValue":l[5]||(l[5]=e=>d.addVaule=e),class:"input-new-tag",size:"mini",onKeyup:g(d.addLinkConfirm,["enter"])},null,8,["modelValue","onKeyup"])):(i(),p(I,{key:1,class:"button-new-tag",size:"small",onClick:d.showAddLink},{default:u((()=>l[10]||(l[10]=[m("+ 新增活动环节")]))),_:1},8,["onClick"]))])),_:1}),s(_,{label:"开始时间"},{default:u((()=>[s(Y,{span:11},{default:u((()=>[s(_,{prop:"beginDate"},{default:u((()=>[s(U,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:d.form.beginDate,"onUpdate:modelValue":l[6]||(l[6]=e=>d.form.beginDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(_,{label:"结束时间"},{default:u((()=>[s(Y,{span:11},{default:u((()=>[s(_,{prop:"endDate"},{default:u((()=>[s(U,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:d.form.endDate,"onUpdate:modelValue":l[7]||(l[7]=e=>d.form.endDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),s(_,{label:"活动描述"},{default:u((()=>[r("div",z,null,512)])),_:1}),s(_,null,{default:u((()=>[s(I,{type:"primary",onClick:d.onSubmit},{default:u((()=>l[11]||(l[11]=[m("保存")]))),_:1},8,["onClick"]),s(I,{onClick:d.onReset},{default:u((()=>l[12]||(l[12]=[m("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["rules","model"])])])])}],["__scopeId","data-v-23dd7f88"]]);export{x as default};
