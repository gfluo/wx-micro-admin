import{k as e,D as l,B as a,b as t,G as d,r as i,o,e as s,f as n,g as r,w as u,F as m,l as c,c as f,i as b,t as p,H as v,E as g,p as k,j as V}from"./vendor.b59db1c2.js";import{W as _}from"./wangEditor.11cdd363.js";import{d as D,e as y,f as h}from"./index.5438c2d2.js";import{_ as C}from"./index.0ab5341f.js";const w={name:"productAdd",setup(){const i=e();let o=!1;const s=l(null),n=l(null),r=l(""),u=l(!1),m=a({title:"",address:"",region:"",beginDate:"",endDate:"",amount:0,describe:"",cover:"",link:[]});let c;t((()=>{console.log("获取到的参数：",i.query.activityId),c=new _(s.value),c.config.zIndex=1,c.create(),null!=i.query.activityId&&(o=!0,D({id:i.query.activityId}).then((e=>{m.title=e.data.title,m.address=e.data.address,m.beginDate=e.data.startTime+"",m.endDate=e.data.endTime+"",m.amount=e.data.amount/100,m.cover=e.data.cover,m.link=e.data.link.split(","),c.txt.html(e.data.describe)})))})),d((()=>{c.destroy(),c=null}));return{addVaule:r,addVisible:u,showAddLink:()=>{u.value=!0},addLinkConfirm:()=>{m.link.push(r.value),r.value="",u.value=!1},addLinkColse:e=>{m.link.splice(m.link.indexOf(e),1)},editor:s,rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],address:[{required:!0,message:"请输入活动地址",trigger:"blur"}],beginDate:[{required:!0,message:"请输入开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},formRef:n,form:m,onSubmit:()=>{m.describe=c.txt.html(),n.value.validate((e=>{if(!e)return!1;o?(h({title:m.title,address:m.address,startTime:m.beginDate,endTime:m.endDate,describe:m.describe,link:m.link,amount:m.amount,cover:m.cover,id:i.query.activityId}).then((e=>{console.log(e)})),g.success("提交成功！")):(y({title:m.title,address:m.address,startTime:m.beginDate,endTime:m.endDate,describe:m.describe,link:m.link,amount:m.amount,cover:m.cover}).then((e=>{console.log(e)})),g.success("提交成功！"))}))},onReset:()=>{n.value.resetFields()}}}},x={class:"crumbs"},z=(e=>(k("data-v-531b41ee"),e=e(),V(),e))((()=>n("i",{class:"el-icon-lx-calendar"},null,-1))),q=b(" 活动 "),Y=b("新增"),U={class:"container"},I={class:"form-box"},L=b("+ 新增活动环节"),T={class:"mgb20",ref:"editor"},j=b("保存"),H=b("重置");var M=C(w,[["render",function(e,l,a,t,d,g){const k=i("el-breadcrumb-item"),V=i("el-breadcrumb"),_=i("el-input"),D=i("el-form-item"),y=i("el-input-number"),h=i("el-tag"),C=i("el-button"),w=i("el-date-picker"),M=i("el-col"),R=i("el-form");return o(),s("div",null,[n("div",x,[r(V,{separator:"/"},{default:u((()=>[r(k,null,{default:u((()=>[z,q])),_:1}),r(k,null,{default:u((()=>[Y])),_:1})])),_:1})]),n("div",U,[n("div",I,[r(R,{ref:"formRef",rules:t.rules,model:t.form,"label-width":"80px"},{default:u((()=>[r(D,{label:"活动名称",prop:"title"},{default:u((()=>[r(_,{size:"mini",modelValue:t.form.title,"onUpdate:modelValue":l[0]||(l[0]=e=>t.form.title=e)},null,8,["modelValue"])])),_:1}),r(D,{label:"活动地址",prop:"address"},{default:u((()=>[r(_,{size:"mini",modelValue:t.form.address,"onUpdate:modelValue":l[1]||(l[1]=e=>t.form.address=e)},null,8,["modelValue"])])),_:1}),r(D,{label:"活动封面",prop:"cover"},{default:u((()=>[r(_,{size:"mini",modelValue:t.form.cover,"onUpdate:modelValue":l[2]||(l[2]=e=>t.form.cover=e),placeholder:"请输入封面图片网络地址"},null,8,["modelValue"])])),_:1}),r(D,{label:"费用(元)",prop:"amount"},{default:u((()=>[r(y,{size:"mini",modelValue:t.form.amount,"onUpdate:modelValue":l[3]||(l[3]=e=>t.form.amount=e),min:1},null,8,["modelValue"])])),_:1}),r(D,{label:"活动环节",prop:"link"},{default:u((()=>[(o(!0),s(m,null,c(t.form.link,(e=>(o(),f(h,{key:e,closable:"","disable-transitions":!1,onClose:l=>t.addLinkColse(e)},{default:u((()=>[b(p(e),1)])),_:2},1032,["onClose"])))),128)),t.addVisible?(o(),f(_,{key:0,modelValue:t.addVaule,"onUpdate:modelValue":l[4]||(l[4]=e=>t.addVaule=e),class:"input-new-tag",size:"mini",onKeyup:v(t.addLinkConfirm,["enter"])},null,8,["modelValue","onKeyup"])):(o(),f(C,{key:1,class:"button-new-tag",size:"small",onClick:t.showAddLink},{default:u((()=>[L])),_:1},8,["onClick"]))])),_:1}),r(D,{label:"开始时间"},{default:u((()=>[r(M,{span:11},{default:u((()=>[r(D,{prop:"beginDate"},{default:u((()=>[r(w,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:t.form.beginDate,"onUpdate:modelValue":l[5]||(l[5]=e=>t.form.beginDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),r(D,{label:"结束时间"},{default:u((()=>[r(M,{span:11},{default:u((()=>[r(D,{prop:"endDate"},{default:u((()=>[r(w,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:t.form.endDate,"onUpdate:modelValue":l[6]||(l[6]=e=>t.form.endDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),r(D,{label:"活动描述"},{default:u((()=>[n("div",T,null,512)])),_:1}),r(D,null,{default:u((()=>[r(C,{type:"primary",onClick:t.onSubmit},{default:u((()=>[j])),_:1},8,["onClick"]),r(C,{onClick:t.onReset},{default:u((()=>[H])),_:1},8,["onClick"])])),_:1})])),_:1},8,["rules","model"])])])])}],["__scopeId","data-v-531b41ee"]]);export{M as default};
