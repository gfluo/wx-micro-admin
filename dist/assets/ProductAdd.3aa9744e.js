import{j as e,B as a,z as l,b as t,G as d,H as o,r as i,o as n,e as r,f as s,g as u,w as m,i as c,F as f,k as b,c as p,t as v,I as g,C as D}from"./vendor.a6d9e6a0.js";import{W as V}from"./wangEditor.789ec17b.js";import{f as k,h as y,i as _}from"./index.7d0f2d56.js";import{_ as h}from"./index.681bbf8e.js";const C={class:"crumbs"},x={class:"container"},z={class:"form-box"},q={class:"mgb20",ref:"editor"};var w=h({name:"productAdd",setup(){const i=e();let n=!1;const r=a(null),s=a(null),u=a(""),m=a(!1),c=l({title:"",address:"",region:"",beginDate:"",endDate:"",amount:0,amountDescribe:"",describe:"",cover:"",link:[]});let f;t((()=>{console.log("获取到的参数：",i.query.activityId),f=new V(r.value),f.config.uploadVideoServer="/common/video/upload",f.config.uploadVideoMaxSize=41943040,f.config.uploadVideoAccept=["mp4"],f.config.uploadVideoName="file",f.config.zIndex=1,f.create(),null!=i.query.activityId&&(n=!0,k({id:i.query.activityId}).then((e=>{c.title=e.data.title,c.address=e.data.address,c.beginDate=e.data.startTime+"",c.endDate=e.data.endTime+"",c.amount=e.data.amount/100,c.cover=e.data.cover,c.link=e.data.link.split(","),c.amountDescribe=e.data.amountDescribe,f.txt.html(e.data.describe)})))})),d((()=>i.path),(()=>{console.log("监听到变化"),console.log("获取到的参数：",i.query.activityId),null!=i.query.activityId&&(n=!0,k({id:i.query.activityId}).then((e=>{c.title=e.data.title,c.address=e.data.address,c.beginDate=e.data.startTime+"",c.endDate=e.data.endTime+"",c.amount=e.data.amount/100,c.cover=e.data.cover,c.link=e.data.link.split(","),c.amountDescribe=e.data.amountDescribe,f.txt.html(e.data.describe)})))})),o((()=>{f.destroy(),f=null}));return{addVaule:u,addVisible:m,showAddLink:()=>{m.value=!0},addLinkConfirm:()=>{c.link.push(u.value),u.value="",m.value=!1},addLinkColse:e=>{c.link.splice(c.link.indexOf(e),1)},editor:r,rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],address:[{required:!0,message:"请输入活动地址",trigger:"blur"}],beginDate:[{required:!0,message:"请输入开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},formRef:s,form:c,onSubmit:()=>{c.describe=f.txt.html(),s.value.validate((e=>{if(!e)return!1;n?(_({title:c.title,address:c.address,startTime:c.beginDate,endTime:c.endDate,describe:c.describe,link:c.link,amount:c.amount,cover:c.cover,id:i.query.activityId,amountDescribe:c.amountDescribe}).then((e=>{console.log(e)})),D.success("提交成功！")):(y({title:c.title,address:c.address,startTime:c.beginDate,endTime:c.endDate,describe:c.describe,link:c.link,amount:c.amount,cover:c.cover,amountDescribe:c.amountDescribe}).then((e=>{console.log(e)})),D.success("提交成功！"))}))},onReset:()=>{s.value.resetFields()}}}},[["render",function(e,a,l,t,d,o){const D=i("el-breadcrumb-item"),V=i("el-breadcrumb"),k=i("el-input"),y=i("el-form-item"),_=i("el-input-number"),h=i("el-tag"),w=i("el-button"),I=i("el-date-picker"),T=i("el-col"),U=i("el-form");return n(),r("div",null,[s("div",C,[u(V,{separator:"/"},{default:m((()=>[u(D,null,{default:m((()=>a[8]||(a[8]=[s("i",{class:"el-icon-lx-calendar"},null,-1),c(" 活动 ")]))),_:1}),u(D,null,{default:m((()=>a[9]||(a[9]=[c("编辑")]))),_:1})])),_:1})]),s("div",x,[s("div",z,[u(U,{ref:"formRef",rules:t.rules,model:t.form,"label-width":"80px"},{default:m((()=>[u(y,{label:"活动名称",prop:"title"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.title,"onUpdate:modelValue":a[0]||(a[0]=e=>t.form.title=e)},null,8,["modelValue"])])),_:1}),u(y,{label:"活动地址",prop:"address"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.address,"onUpdate:modelValue":a[1]||(a[1]=e=>t.form.address=e)},null,8,["modelValue"])])),_:1}),u(y,{label:"活动封面",prop:"cover"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.cover,"onUpdate:modelValue":a[2]||(a[2]=e=>t.form.cover=e),placeholder:"请输入封面图片网络地址"},null,8,["modelValue"])])),_:1}),u(y,{label:"费用(元)",prop:"amount"},{default:m((()=>[u(_,{size:"mini",modelValue:t.form.amount,"onUpdate:modelValue":a[3]||(a[3]=e=>t.form.amount=e),min:0},null,8,["modelValue"])])),_:1}),u(y,{label:"费用描述",prop:"amountDescribe"},{default:m((()=>[u(k,{size:"mini",modelValue:t.form.amountDescribe,"onUpdate:modelValue":a[4]||(a[4]=e=>t.form.amountDescribe=e)},null,8,["modelValue"])])),_:1}),u(y,{label:"活动环节",prop:"link"},{default:m((()=>[(n(!0),r(f,null,b(t.form.link,(e=>(n(),p(h,{key:e,closable:"","disable-transitions":!1,onClose:a=>t.addLinkColse(e)},{default:m((()=>[c(v(e),1)])),_:2},1032,["onClose"])))),128)),t.addVisible?(n(),p(k,{key:0,modelValue:t.addVaule,"onUpdate:modelValue":a[5]||(a[5]=e=>t.addVaule=e),class:"input-new-tag",size:"mini",onKeyup:g(t.addLinkConfirm,["enter"])},null,8,["modelValue","onKeyup"])):(n(),p(w,{key:1,class:"button-new-tag",size:"small",onClick:t.showAddLink},{default:m((()=>a[10]||(a[10]=[c("+ 新增活动环节")]))),_:1},8,["onClick"]))])),_:1}),u(y,{label:"开始时间"},{default:m((()=>[u(T,{span:11},{default:m((()=>[u(y,{prop:"beginDate"},{default:m((()=>[u(I,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:t.form.beginDate,"onUpdate:modelValue":a[6]||(a[6]=e=>t.form.beginDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(y,{label:"结束时间"},{default:m((()=>[u(T,{span:11},{default:m((()=>[u(y,{prop:"endDate"},{default:m((()=>[u(I,{size:"mini",type:"datetime",placeholder:"选择日期","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:t.form.endDate,"onUpdate:modelValue":a[7]||(a[7]=e=>t.form.endDate=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(y,{label:"活动描述"},{default:m((()=>[s("div",q,null,512)])),_:1}),u(y,null,{default:m((()=>[u(w,{type:"primary",onClick:t.onSubmit},{default:m((()=>a[11]||(a[11]=[c("保存")]))),_:1},8,["onClick"]),u(w,{onClick:t.onReset},{default:m((()=>a[12]||(a[12]=[c("重置")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["rules","model"])])])])}],["__scopeId","data-v-5499eb3a"]]);export{w as default};
